generator client {
provider = "prisma-client-js"
}


datasource db {
provider = "sqlite"
url = env("DATABASE_URL")
}


model User {
id String @id @default(cuid())
email String @unique
password String
role Role @default(USER)
sessions Session[]
keys Key[]
createdAt DateTime @default(now())
updatedAt DateTime @updatedAt
}


enum Role {
USER
ADMIN
}


model Session {
id String @id @default(cuid())
userId String
user User @relation(fields: [userId], references: [id], onDelete: Cascade)
expiration DateTime
createdAt DateTime @default(now())
}


model Key {
  id String @id @default(cuid())
  userId String
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  name String
  description String?
  unit String? // Unidad opcional
  door String? // Puerta opcional
  notes String? // Notas opcionales
  imageData Bytes? // Imagen como datos binarios
  imageMimeType String? // Tipo de imagen (image/jpeg, image/png, etc.)
  signature Json? // Vector de caracter√≠sticas
  sigStatus String @default("pending") // 'pending' | 'ready' | 'failed'
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  @@map("keys")
}

